!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).CropTag=e()}(this,function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function n(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var a="croptag.ready",r="mousedown",i="mousemove",c="mouseup",s="crop-tag-error",l="crop-tag-mask",u="crop-tag-wrap",d="crop-tag-element",f="crop-tag-dot",h="crop-tag-edge";function g(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=document.createElement(t);return Object.keys(e).forEach(function(t){o.setAttribute(t,e[t])}),n&&(o.innerHTML=n),o}function p(t,e,n){var a=t instanceof NodeList||t instanceof HTMLCollection?o(t):t instanceof Node?[t]:[];if(0===a.length){if("string"!=typeof t)throw new TypeError("Image should be a valid DOM element or URL");if(!(n instanceof Node))throw new TypeError("Target node is unavailable");var r=g("img",{src:t,alt:e||"CropTag image"});n.appendChild(r),a.push(n)}return function(t){t.forEach(function(t){var e=g("div",{style:"position: relative; width: 100%; height: 100%;",class:u});t.parentNode.insertBefore(e,t),e.appendChild(t),e.appendChild(g("div",{style:"position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1;",class:l}))})}(a),a}function m(e){var n=e.e,o=e.dots,a=e.edges,r=e.drag,i=e.defaultDots,c=this.getBoundingClientRect(),s=n.clientX-c.left,l=n.clientY-c.top,u=g("div",{class:"".concat(d).concat(r?" ".concat(d,"--drag"):""),style:"position: absolute; top: ".concat(l,"px; left: ").concat(s,"px;")});if(o){var p=i;"object"===t(o)&&function(t,e){var n=!0;if(Object.keys(t).forEach(function(t){t in e||(n=!1)}),!n)throw new Error("Input dots does not match current schema. Accepted values are ".concat(Object.keys(e).join(", ")));return n}(o,i)&&(p=o),Object.keys(p).forEach(function(t){u.appendChild(g("div",{class:"".concat(f," ").concat(f,"--").concat(p[t])}))})}return a&&r&&["top","left","bottom","right"].forEach(function(t){u.appendChild(g("div",{class:"".concat(h," ").concat(h,"--drag ").concat(h,"--").concat(t)}))}),this.appendChild(u),u}return function(){function t(e){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n(this,"originalImages",[]),n(this,"defaultDots",{TL:"top-left",T:"top",TR:"top-right",R:"right",BR:"bottom-right",B:"bottom",BL:"bottom-left",L:"left"}),e=e||{},this.config=Object.assign({dots:!0,edges:!0,drag:!0,focussedTags:!1,image:null,imageAlt:null,target:null},e);var u=this.config,f=u.image,h=u.imageAlt,g=u.target;(function(t){var e=this;return Promise.all(t.map(function(t){return new Promise(function(n){if(t.complete){var o=0===t.naturalWidth||0===t.naturalHeight;o&&t.classList.add(s),n(),e.originalImages.push({img:t,src:t.src,width:t.naturalWidth,height:t.naturalHeight,hasErrors:o})}else t.onload=function(){n(),e.originalImages.push({img:t,src:t.src,width:t.naturalWidth,height:t.naturalHeight,hasErrors:!1})},t.onerror=function(){t.classList.add(s),n(),e.originalImages.push({img:t,src:t.src,width:t.naturalWidth,height:t.naturalHeight,hasErrors:!0})}})})).then(function(){return e.originalImages})}).apply(this,[p(f,h,g)]).then(function(t){var e=new CustomEvent(a,{bubbles:!0,cancelable:!0,detail:{payload:t}});t.forEach(function(t){t.img.dispatchEvent(e)}),function(){var t=this,e=this.config,n=e.dots,o=e.edges,a=e.drag,s=this.defaultDots;document.addEventListener(r,function(e){var r=e.target;if(o&&r.classList.contains(d)&&(r=r.parentNode),r.classList.contains(l)){var c=m.apply(r,[{e:e,dots:n,edges:o,drag:a,defaultDots:s}]),u=e.clientX,f=e.clientY,h=c.style.left,g=c.style.top,p=r.getBoundingClientRect();t.drawHandler=function(t){var e=t.clientX,n=t.clientY,o=e-u,a=n-f,r=c.getBoundingClientRect(),i=p.width-r.left,s=p.height-r.top;console.log(i,s),c.style.width="".concat(Math.abs(o<i?o:i)/p.width*100,"%"),c.style.height="".concat(Math.abs(a<s?a:s)/p.height*100,"%");var l=(parseFloat(h)+o)/p.width*100,d=(parseFloat(g)+a)/p.height*100,m=l>0?l:0,y=d>0?d:0;o<0&&(c.style.left="".concat(m,"%")),a<0&&(c.style.top="".concat(y,"%"))},document.addEventListener(i,t.drawHandler)}}),document.addEventListener(c,function(){document.removeEventListener(i,t.drawHandler),t.drawHandler=null})}.apply(o)})}var o,u,f;return o=t,(u=[{key:"getAll",value:function(){}},{key:"get",value:function(t){}}])&&e(o.prototype,u),f&&e(o,f),t}()});
//# sourceMappingURL=index.js.map
